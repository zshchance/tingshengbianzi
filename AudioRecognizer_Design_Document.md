# éŸ³é¢‘è¯†åˆ«åº”ç”¨è®¾è®¡æ–‡æ¡£

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®ç®€ä»‹
æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºGoè¯­è¨€å’ŒVoskè¯­éŸ³è¯†åˆ«å¼•æ“çš„è·¨å¹³å°æ¡Œé¢åº”ç”¨ï¼Œæ—¨åœ¨ä¸ºç”¨æˆ·æä¾›ç®€å•æ˜“ç”¨çš„éŸ³é¢‘æ–‡ä»¶è½¬å½•æœåŠ¡ã€‚åº”ç”¨æ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼ï¼Œèƒ½å¤Ÿç”Ÿæˆå¸¦æœ‰æ—¶é—´æ ‡è®°çš„æ–‡æœ¬ç»“æœï¼Œå¹¶æä¾›äº†AIä¼˜åŒ–åŠŸèƒ½ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›ä¸€æ­¥å¤„ç†è¯†åˆ«ç»“æœã€‚

### 1.2 æ ¸å¿ƒåŠŸèƒ½
- **å¤šæ ¼å¼éŸ³é¢‘æ”¯æŒ**: æ”¯æŒMP3ã€WAVã€M4Aã€FLACç­‰å¸¸è§éŸ³é¢‘æ ¼å¼
- **å®æ—¶è¯­éŸ³è¯†åˆ«**: åŸºäºVoskå¼•æ“çš„ç¦»çº¿è¯­éŸ³è¯†åˆ«
- **æ—¶é—´æ ‡è®°ç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆç²¾ç¡®åˆ°æ¯«ç§’çš„æ—¶é—´æˆ³
- **æ™ºèƒ½æ–‡æœ¬ä¼˜åŒ–**: æä¾›AIå‹å¥½çš„ä¼˜åŒ–æç¤ºè¯
- **è·¨å¹³å°è¿è¡Œ**: æ”¯æŒWindowsã€macOSã€Linuxä¸‰å¤§å¹³å°
- **è‡ªå®šä¹‰æ¨¡å‹**: æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è¯­éŸ³è¯†åˆ«æ¨¡å‹

### 1.3 ç›®æ ‡ç”¨æˆ·
- éœ€è¦åˆ¶ä½œå­—å¹•çš„è§†é¢‘åˆ›ä½œè€…
- éœ€è¦æ•´ç†å½•éŸ³å†…å®¹çš„ä¼šè®®è®°å½•è€…
- éœ€è¦æå–æ­Œè¯çš„éŸ³ä¹çˆ±å¥½è€…
- éœ€è¦è½¬å½•éŸ³é¢‘å†…å®¹çš„æ–‡å­—å·¥ä½œè€…

## 2. éœ€æ±‚åˆ†æ

### 2.1 åŠŸèƒ½æ€§éœ€æ±‚

#### 2.1.1 éŸ³é¢‘å¤„ç†éœ€æ±‚
| éœ€æ±‚ID | éœ€æ±‚æè¿° | ä¼˜å…ˆçº§ |
|--------|----------|--------|
| FR-001 | æ”¯æŒå¸¸è§éŸ³é¢‘æ ¼å¼å¯¼å…¥ | é«˜ |
| FR-002 | è‡ªåŠ¨éŸ³é¢‘æ ¼å¼è½¬æ¢ | é«˜ |
| FR-003 | éŸ³é¢‘é¢„å¤„ç†å’Œé™å™ª | ä¸­ |
| FR-004 | æ”¯æŒå¤§æ–‡ä»¶åˆ†å—å¤„ç† | é«˜ |

#### 2.1.2 è¯­éŸ³è¯†åˆ«éœ€æ±‚
| éœ€æ±‚ID | éœ€æ±‚æè¿° | ä¼˜å…ˆçº§ |
|--------|----------|--------|
| FR-005 | å¤šè¯­è¨€è¯†åˆ«æ”¯æŒ | é«˜ |
| FR-006 | è‡ªå®šä¹‰è¯†åˆ«æ¨¡å‹ | ä¸­ |
| FR-007 | å®æ—¶è¯†åˆ«è¿›åº¦æ˜¾ç¤º | é«˜ |
| FR-008 | ç½®ä¿¡åº¦è¯„åˆ† | ä¸­ |

#### 2.1.3 ç»“æœå¤„ç†éœ€æ±‚
| éœ€æ±‚ID | éœ€æ±‚æè¿° | ä¼˜å…ˆçº§ |
|--------|----------|--------|
| FR-009 | æ—¶é—´æˆ³æ ‡è®°ç”Ÿæˆ | é«˜ |
| FR-010 | æ–‡æœ¬ç»“æœå¯¼å‡º | é«˜ |
| FR-011 | AIä¼˜åŒ–æç¤ºç”Ÿæˆ | ä¸­ |
| FR-012 | å¤šç§å¤åˆ¶æ ¼å¼ | é«˜ |

### 2.2 éåŠŸèƒ½æ€§éœ€æ±‚

#### 2.2.1 æ€§èƒ½éœ€æ±‚
- éŸ³é¢‘å¤„ç†é€Ÿåº¦: å®æ—¶å¤„ç†é€Ÿåº¦ä¸ä½äºéŸ³é¢‘æ’­æ”¾é€Ÿåº¦çš„1.5å€
- å†…å­˜ä½¿ç”¨: å¤„ç†100MBéŸ³é¢‘æ–‡ä»¶æ—¶å†…å­˜å ç”¨ä¸è¶…è¿‡512MB
- å¯åŠ¨æ—¶é—´: åº”ç”¨å¯åŠ¨æ—¶é—´ä¸è¶…è¿‡5ç§’

#### 2.2.2 å¯ç”¨æ€§éœ€æ±‚
- ç•Œé¢å“åº”æ—¶é—´: ç”¨æˆ·æ“ä½œå“åº”æ—¶é—´ä¸è¶…è¿‡200ms
- æ“ä½œç®€ä¾¿æ€§: æ–°ç”¨æˆ·æ— éœ€é˜…è¯»æ–‡æ¡£å³å¯å®ŒæˆåŸºæœ¬æ“ä½œ
- é”™è¯¯å¤„ç†: æä¾›æ¸…æ™°çš„é”™è¯¯æç¤ºå’Œè§£å†³å»ºè®®

#### 2.2.3 å…¼å®¹æ€§éœ€æ±‚
- æ“ä½œç³»ç»Ÿ: Windows 10+, macOS 10.15+, Ubuntu 18.04+
- æ¶æ„æ”¯æŒ: x64, ARM64
- æ–‡ä»¶æ ¼å¼: MP3, WAV, M4A, FLAC, OGG

### 2.3 ç³»ç»Ÿçº¦æŸ
- å¼€å‘è¯­è¨€: Go 1.21+
- UIæ¡†æ¶: Wails v2
- è¯­éŸ³è¯†åˆ«: Vosk API
- éƒ¨ç½²æ–¹å¼: å•æ–‡ä»¶å¯æ‰§è¡Œç¨‹åº
- è®¸å¯è¯: MIT License

## 3. æŠ€æœ¯æ–¹æ¡ˆ

### 3.1 æŠ€æœ¯æ ˆé€‰æ‹©

#### 3.1.1 åç«¯æŠ€æœ¯
- **Goè¯­è¨€**: é«˜æ€§èƒ½ã€è·¨å¹³å°ã€å•æ–‡ä»¶éƒ¨ç½²
- **Vosk API**: å¼€æºç¦»çº¿è¯­éŸ³è¯†åˆ«å¼•æ“
- **FFmpeg**: éŸ³é¢‘æ ¼å¼è½¬æ¢å’Œå¤„ç†
- **Wails v2**: ç°ä»£åŒ–çš„æ¡Œé¢åº”ç”¨å¼€å‘æ¡†æ¶

#### 3.1.2 å‰ç«¯æŠ€æœ¯
- **HTML5/CSS3**: ç°ä»£åŒ–ç”¨æˆ·ç•Œé¢
- **JavaScript ES6+**: äº¤äº’é€»è¾‘å®ç°
- **Web Components**: å¯å¤ç”¨UIç»„ä»¶

### 3.2 æ¶æ„è®¾è®¡

#### 3.2.1 æ•´ä½“æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç”¨æˆ·ç•Œé¢å±‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ä¸»ç•Œé¢    â”‚ â”‚    è®¾ç½®ç•Œé¢         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              ä¸šåŠ¡é€»è¾‘å±‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ éŸ³é¢‘å¤„ç†æœåŠ¡ â”‚ â”‚  è¯­éŸ³è¯†åˆ«æœåŠ¡       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç»“æœå¤„ç†æœåŠ¡ â”‚ â”‚  é…ç½®ç®¡ç†æœåŠ¡       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              æ•°æ®è®¿é—®å±‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  æ–‡ä»¶ç³»ç»Ÿ   â”‚ â”‚    Voskå¼•æ“         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2.2 æ¨¡å—ä¾èµ–å…³ç³»
```mermaid
graph TD
    A[UIç•Œé¢] --> B[éŸ³é¢‘å¤„ç†æœåŠ¡]
    A --> C[è¯­éŸ³è¯†åˆ«æœåŠ¡]
    A --> D[ç»“æœå¤„ç†æœåŠ¡]
    A --> E[é…ç½®ç®¡ç†æœåŠ¡]

    B --> F[FFmpegè½¬æ¢å™¨]
    B --> G[éŸ³é¢‘é¢„å¤„ç†å™¨]

    C --> H[Voskå¼•æ“]
    C --> I[æ¨¡å‹ç®¡ç†å™¨]

    D --> J[æ—¶é—´æ ‡è®°å¤„ç†å™¨]
    D --> K[æ–‡æœ¬ä¼˜åŒ–å™¨]

    E --> L[é…ç½®æ–‡ä»¶]
    E --> M[æ¨¡å‹æ–‡ä»¶]
```

### 3.3 å…³é”®æŠ€æœ¯å†³ç­–

#### 3.3.1 è¯­éŸ³è¯†åˆ«å¼•æ“é€‰æ‹©
é€‰æ‹©Voskçš„åŸå› ï¼š
- æ”¯æŒç¦»çº¿è¯†åˆ«ï¼Œæ— éœ€ç½‘ç»œè¿æ¥
- æä¾›Goè¯­è¨€APIç»‘å®š
- æ”¯æŒå¤šè¯­è¨€å’Œè‡ªå®šä¹‰æ¨¡å‹
- ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£å®Œå–„
- è½»é‡çº§ï¼Œé€‚åˆæ¡Œé¢åº”ç”¨é›†æˆ

#### 3.3.2 UIæ¡†æ¶é€‰æ‹©
é€‰æ‹©Wailsçš„åŸå› ï¼š
- åŸç”Ÿæ€§èƒ½ï¼Œæ¥è¿‘Electronä½†èµ„æºå ç”¨æ›´ä½
- ä½¿ç”¨WebæŠ€æœ¯å¼€å‘ç•Œé¢ï¼Œå­¦ä¹ æˆæœ¬ä½
- å®Œç¾æ”¯æŒGoåç«¯é›†æˆ
- æ”¯æŒè·¨å¹³å°æ‰“åŒ…å’Œåˆ†å‘
- å•æ–‡ä»¶éƒ¨ç½²ï¼Œç”¨æˆ·å®‰è£…ç®€ä¾¿

#### 3.3.3 éŸ³é¢‘å¤„ç†æ–¹æ¡ˆ
é€‰æ‹©FFmpegçš„åŸå› ï¼š
- æ”¯æŒæœ€å¹¿æ³›çš„éŸ³é¢‘æ ¼å¼
- é«˜è´¨é‡éŸ³é¢‘è½¬æ¢ç®—æ³•
- è·¨å¹³å°æ”¯æŒ
- æˆç†Ÿç¨³å®šï¼Œæ€§èƒ½ä¼˜ç§€

## 4. ç³»ç»Ÿè®¾è®¡

### 4.1 é¡¹ç›®ç»“æ„
```
audio-recognizer/
â”œâ”€â”€ app.go                    # Wailsåº”ç”¨ä¸»å…¥å£
â”œâ”€â”€ wails.json               # Wailsé…ç½®æ–‡ä»¶
â”œâ”€â”€ main.go                  # Goç¨‹åºå…¥å£
â”œâ”€â”€ embed.go                 # åµŒå…¥èµ„æºæ–‡ä»¶
â”œâ”€â”€ go.mod                   # Goæ¨¡å—å®šä¹‰
â”œâ”€â”€ go.sum                   # Goä¾èµ–é”å®š
â”œâ”€â”€
â”œâ”€â”€ backend/                 # åç«¯ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ audio/               # éŸ³é¢‘å¤„ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ processor.go     # éŸ³é¢‘å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ converter.go     # æ ¼å¼è½¬æ¢å™¨
â”‚   â”‚   â””â”€â”€ preprocessor.go  # éŸ³é¢‘é¢„å¤„ç†
â”‚   â”œâ”€â”€ recognition/         # è¯­éŸ³è¯†åˆ«æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ vosk_client.go   # Voskå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ model_manager.go # æ¨¡å‹ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ result_parser.go # ç»“æœè§£æå™¨
â”‚   â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ recognition.go   # è¯†åˆ«ç»“æœæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ config.go        # é…ç½®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ audio_file.go    # éŸ³é¢‘æ–‡ä»¶æ¨¡å‹
â”‚   â”œâ”€â”€ services/            # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ recognition_service.go  # è¯†åˆ«æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ file_service.go         # æ–‡ä»¶æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ config_service.go       # é…ç½®æœåŠ¡
â”‚   â”‚   â””â”€â”€ export_service.go       # å¯¼å‡ºæœåŠ¡
â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ time_utils.go    # æ—¶é—´å¤„ç†å·¥å…·
â”‚       â”œâ”€â”€ text_utils.go    # æ–‡æœ¬å¤„ç†å·¥å…·
â”‚       â”œâ”€â”€ file_utils.go    # æ–‡ä»¶æ“ä½œå·¥å…·
â”‚       â””â”€â”€ logger.go        # æ—¥å¿—å·¥å…·
â”‚
â”œâ”€â”€ frontend/                # å‰ç«¯èµ„æº
â”‚   â”œâ”€â”€ index.html           # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ components/          # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ file-selector.html     # æ–‡ä»¶é€‰æ‹©ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ progress-bar.html      # è¿›åº¦æ¡ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ result-display.html    # ç»“æœæ˜¾ç¤ºç»„ä»¶
â”‚   â”‚   â””â”€â”€ settings-panel.html    # è®¾ç½®é¢æ¿ç»„ä»¶
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”œâ”€â”€ main.css        # ä¸»æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ components.css  # ç»„ä»¶æ ·å¼
â”‚   â”‚   â””â”€â”€ themes.css      # ä¸»é¢˜æ ·å¼
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ main.js          # ä¸»JSæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ app.js           # åº”ç”¨é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ components.js    # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ utils.js         # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ api.js           # APIæ¥å£å°è£…
â”‚   â””â”€â”€ assets/              # é™æ€èµ„æº
â”‚       â”œâ”€â”€ icons/           # å›¾æ ‡æ–‡ä»¶
â”‚       â””â”€â”€ fonts/           # å­—ä½“æ–‡ä»¶
â”‚
â”œâ”€â”€ models/                  # è¯­éŸ³è¯†åˆ«æ¨¡å‹
â”‚   â”œâ”€â”€ README.md           # æ¨¡å‹è¯´æ˜æ–‡ä»¶
â”‚   â”œâ”€â”€ zh-CN/              # ä¸­æ–‡æ¨¡å‹ç›®å½•
â”‚   â”œâ”€â”€ en-US/              # è‹±æ–‡æ¨¡å‹ç›®å½•
â”‚   â””â”€â”€ ja-JP/              # æ—¥æ–‡æ¨¡å‹ç›®å½•
â”‚
â”œâ”€â”€ config/                  # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ default.json        # é»˜è®¤é…ç½®
â”‚   â”œâ”€â”€ languages.json      # è¯­è¨€é…ç½®
â”‚   â””â”€â”€ templates.json      # AIæç¤ºè¯æ¨¡æ¿
â”‚
â”œâ”€â”€ scripts/                 # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ build.sh            # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ package.sh          # æ‰“åŒ…è„šæœ¬
â”‚   â”œâ”€â”€ download-models.sh  # æ¨¡å‹ä¸‹è½½è„šæœ¬
â”‚   â””â”€â”€ install-deps.sh     # ä¾èµ–å®‰è£…è„šæœ¬
â”‚
â”œâ”€â”€ docs/                    # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ API.md              # APIæ–‡æ¡£
â”‚   â”œâ”€â”€ DEPLOYMENT.md       # éƒ¨ç½²æ–‡æ¡£
â”‚   â””â”€â”€ TROUBLESHOOTING.md  # æ•…éšœæ’é™¤æ–‡æ¡£
â”‚
â”œâ”€â”€ tests/                   # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ unit/               # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/        # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ testdata/           # æµ‹è¯•æ•°æ®
â”‚
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

### 4.2 æ ¸å¿ƒç»„ä»¶è®¾è®¡

#### 4.2.1 éŸ³é¢‘å¤„ç†æœåŠ¡
```go
type AudioProcessor struct {
    converter   *AudioConverter
    preprocessor *AudioPreprocessor
    logger      *logger.Logger
}

type AudioProcessingOptions struct {
    SampleRate   int     `json:"sampleRate"`
    Channels     int     `json:"channels"`
    Format       string  `json:"format"`
    Quality      string  `json:"quality"`
    Normalize    bool    `json:"normalize"`
    RemoveNoise  bool    `json:"removeNoise"`
}
```

#### 4.2.2 è¯­éŸ³è¯†åˆ«æœåŠ¡
```go
type RecognitionService struct {
    voskClient   *vosk.VoskClient
    modelManager *ModelManager
    config       *RecognitionConfig
}

type RecognitionRequest struct {
    AudioPath     string              `json:"audioPath"`
    Language      string              `json:"language"`
    ModelPath     string              `json:"modelPath"`
    Options       RecognitionOptions  `json:"options"`
}

type RecognitionOptions struct {
    MaxAlternatives    int  `json:"maxAlternatives"`
    WordAlternatives   bool `json:"wordAlternatives"`
    PartialResults     bool `json:"partialResults"`
    Timestamps         bool `json:"timestamps"`
    ConfidenceThreshold float64 `json:"confidenceThreshold"`
}
```

#### 4.2.3 ç»“æœå¤„ç†æœåŠ¡
```go
type ResultProcessor struct {
    textFormatter *TextFormatter
    aiOptimizer   *AIOptimizer
    exporter      *Exporter
}

type ProcessingOptions struct {
    Format          string `json:"format"`
    IncludeTimestamp bool   `json:"includeTimestamp"`
    IncludeConfidence bool  `json:"includeConfidence"`
    EnableAIOptimization bool `json:"enableAIOptimization"`
    OutputFormat    string `json:"outputFormat"`
}
```

## 5. æ•°æ®æ¨¡å‹è®¾è®¡

### 5.1 æ ¸å¿ƒæ•°æ®ç»“æ„

#### 5.1.1 è¯†åˆ«ç»“æœæ¨¡å‹
```go
// RecognitionResult è¯­éŸ³è¯†åˆ«ç»“æœ
type RecognitionResult struct {
    ID          string             `json:"id"`
    AudioFile   *AudioFileInfo     `json:"audioFile"`
    Language    string             `json:"language"`
    Duration    time.Duration      `json:"duration"`
    Segments    []RecognitionSegment `json:"segments"`
    Words       []Word            `json:"words"`
    Confidence  float64           `json:"confidence"`
    CreatedAt   time.Time         `json:"createdAt"`
    ProcessedAt time.Time         `json:"processedAt"`
}

// RecognitionResultSegment è¯†åˆ«ç»“æœæ®µè½
type RecognitionResultSegment struct {
    Start       time.Time `json:"start"`
    End         time.Time `json:"end"`
    Text        string    `json:"text"`
    Confidence  float64   `json:"confidence"`
    Words       []Word    `json:"words"`
    Metadata    map[string]interface{} `json:"metadata"`
}

// Word è¯æ±‡ä¿¡æ¯
type Word struct {
    Text       string    `json:"text"`
    Start      time.Time `json:"start"`
    End        time.Time `json:"end"`
    Confidence float64   `json:"confidence"`
    Speaker    string    `json:"speaker,omitempty"`
}
```

#### 5.1.2 éŸ³é¢‘æ–‡ä»¶æ¨¡å‹
```go
// AudioFileInfo éŸ³é¢‘æ–‡ä»¶ä¿¡æ¯
type AudioFileInfo struct {
    Path         string        `json:"path"`
    Name         string        `json:"name"`
    Size         int64         `json:"size"`
    Duration     time.Duration `json:"duration"`
    Format       string        `json:"format"`
    SampleRate   int           `json:"sampleRate"`
    Channels     int           `json:"channels"`
    Bitrate      int           `json:"bitrate"`
    Metadata     map[string]string `json:"metadata"`
}
```

#### 5.1.3 é…ç½®æ¨¡å‹
```go
// AppConfig åº”ç”¨é…ç½®
type AppConfig struct {
    Recognition RecognitionConfig `json:"recognition"`
    Audio       AudioConfig       `json:"audio"`
    UI          UIConfig          `json:"ui"`
    Export      ExportConfig      `json:"export"`
}

// RecognitionConfig è¯­éŸ³è¯†åˆ«é…ç½®
type RecognitionConfig struct {
    DefaultLanguage     string  `json:"defaultLanguage"`
    ModelDirectory      string  `json:"modelDirectory"`
    AutoDetectLanguage  bool    `json:"autoDetectLanguage"`
    ConfidenceThreshold float64 `json:"confidenceThreshold"`
    MaxAlternatives     int     `json:"maxAlternatives"`
    EnableWordTimestamp bool    `json:"enableWordTimestamp"`
}

// AudioConfig éŸ³é¢‘å¤„ç†é…ç½®
type AudioConfig struct {
    SampleRate       int    `json:"sampleRate"`
    Channels         int    `json:"channels"`
    Format           string `json:"format"`
    Normalize        bool   `json:"normalize"`
    RemoveNoise      bool   `json:"removeNoise"`
    SilenceThreshold  int    `json:"silenceThreshold"`
}
```

### 5.2 æ•°æ®æ ¼å¼è§„èŒƒ

#### 5.2.1 æ—¶é—´æ ‡è®°æ ¼å¼
```
æ ¼å¼: [HH:MM:SS.mmm]
ç¤ºä¾‹: [00:01:23.456] è¿™æ˜¯ä¸€æ®µè¯†åˆ«æ–‡æœ¬
```

#### 5.2.2 ç‰¹æ®Šæ ‡è®°è§„èŒƒ
```json
{
  "timeStamp": {
    "pattern": "\\[(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d{3})\\]",
    "description": "æ—¶é—´æˆ³æ ‡è®°ï¼Œç²¾ç¡®åˆ°æ¯«ç§’"
  },
  "emphasis": {
    "start": "ã€å¼ºè°ƒã€‘",
    "end": "ã€/å¼ºè°ƒã€‘",
    "description": "å¼ºè°ƒå†…å®¹æ ‡è®°"
  },
  "pause": {
    "short": "ã€åœé¡¿Â·çŸ­ã€‘",
    "medium": "ã€åœé¡¿Â·ä¸­ã€‘",
    "long": "ã€åœé¡¿Â·é•¿ã€‘",
    "description": "åœé¡¿æ—¶é•¿æ ‡è®°"
  },
  "unclear": {
    "pattern": "ã€ä¸æ¸…:%sã€‘",
    "description": "ä¸æ¸…æ™°è¯æ±‡æ ‡è®°"
  },
  "music": {
    "start": "ã€éŸ³ä¹ã€‘",
    "end": "ã€/éŸ³ä¹ã€‘",
    "description": "éŸ³ä¹ç‰‡æ®µæ ‡è®°"
  },
  "speaker": {
    "pattern": "ã€è¯´è¯äºº:%sã€‘",
    "description": "è¯´è¯äººåˆ‡æ¢æ ‡è®°"
  },
  "language": {
    "pattern": "ã€è¯­è¨€:%sã€‘",
    "description": "è¯­è¨€åˆ‡æ¢æ ‡è®°"
  }
}
```

#### 5.2.3 AIä¼˜åŒ–æç¤ºè¯æ¨¡æ¿
```
è¯·ä¼˜åŒ–ä»¥ä¸‹éŸ³é¢‘è¯†åˆ«ç»“æœï¼Œè¦æ±‚ï¼š

1. åŸºç¡€ä¼˜åŒ–
   - ä¿®æ­£æ˜æ˜¾çš„é”™åˆ«å­—å’Œè¯­æ³•é”™è¯¯
   - ä¼˜åŒ–æ–­å¥å’Œæ ‡ç‚¹ç¬¦å·
   - ä¿æŒè¯­ä¹‰å®Œæ•´æ€§å’Œè¿è´¯æ€§

2. æ ‡è®°å¤„ç†
   - ä¿ç•™æ‰€æœ‰æ—¶é—´æ ‡è®° [HH:MM:SS.mmm] ä¸å˜
   - å¤„ç†ç‰¹æ®Šæ ‡è®°ï¼š
     * ã€å¼ºè°ƒã€‘...ã€/å¼ºè°ƒã€‘â†’ ä¿ç•™å¹¶ä¼˜åŒ–å¼ºè°ƒå†…å®¹
     * ã€ä¸æ¸…:xxxã€‘â†’ æ ¹æ®ä¸Šä¸‹æ–‡æ¨æµ‹æˆ–æ ‡è®°ä¸º[å¬ä¸æ¸…]
     * ã€éŸ³ä¹ã€‘...ã€/éŸ³ä¹ã€‘â†’ ä¿ç•™éŸ³ä¹ç‰‡æ®µæ ‡è®°
     * ã€åœé¡¿Â·çŸ­/ä¸­/é•¿ã€‘â†’ è½¬æ¢ä¸ºåˆé€‚çš„æ ‡ç‚¹ç¬¦å·

3. å†…å®¹ä¼˜åŒ–
   - ä¿®æ­£ä¸“ä¸šæœ¯è¯­å’Œä¸“æœ‰åè¯
   - ä¼˜åŒ–å£è¯­åŒ–è¡¨è¾¾
   - ä¿æŒåŸæ–‡è¯­æ°”å’Œé£æ ¼
   - è¯†åˆ«å¹¶æ ‡è®°é‡è¦ä¿¡æ¯

4. è¾“å‡ºæ ¼å¼
   - ä¿æŒåŸæœ‰æ—¶é—´æ ‡è®°æ ¼å¼
   - ä½¿ç”¨è§„èŒƒçš„æ ‡ç‚¹ç¬¦å·
   - æ®µè½æ¸…æ™°ï¼Œä¾¿äºé˜…è¯»

åŸå§‹è¯†åˆ«ç»“æœï¼š
ã€RECOGNITION_TEXTã€‘

ä¼˜åŒ–åçš„æ–‡æœ¬ï¼š
```

## 6. æ¥å£è®¾è®¡

### 6.1 åç«¯APIæ¥å£

#### 6.1.1 éŸ³é¢‘å¤„ç†æ¥å£
```go
// AudioProcessor éŸ³é¢‘å¤„ç†æ¥å£
type AudioProcessor interface {
    // ProcessAudio å¤„ç†éŸ³é¢‘æ–‡ä»¶
    ProcessAudio(inputPath string, options *AudioProcessingOptions) (*ProcessedAudio, error)

    // GetAudioInfo è·å–éŸ³é¢‘ä¿¡æ¯
    GetAudioInfo(path string) (*AudioFileInfo, error)

    // ConvertFormat è½¬æ¢éŸ³é¢‘æ ¼å¼
    ConvertFormat(inputPath, outputPath, format string) error

    // ValidateFormat éªŒè¯éŸ³é¢‘æ ¼å¼
    ValidateFormat(path string) (bool, error)
}
```

#### 6.1.2 è¯­éŸ³è¯†åˆ«æ¥å£
```go
// RecognitionService è¯­éŸ³è¯†åˆ«æœåŠ¡æ¥å£
type RecognitionService interface {
    // RecognizeAudio è¯†åˆ«éŸ³é¢‘æ–‡ä»¶
    RecognizeAudio(req *RecognitionRequest) (*RecognitionResult, error)

    // RecognizeStream æµå¼è¯†åˆ«éŸ³é¢‘
    RecognizeStream(audioStream io.Reader, options *RecognitionOptions) (<-chan *RecognitionResult, error)

    // GetSupportedLanguages è·å–æ”¯æŒçš„è¯­è¨€åˆ—è¡¨
    GetSupportedLanguages() ([]Language, error)

    // LoadModel åŠ è½½è¯†åˆ«æ¨¡å‹
    LoadModel(language, modelPath string) error

    // UnloadModel å¸è½½è¯†åˆ«æ¨¡å‹
    UnloadModel(language string) error
}
```

#### 6.1.3 ç»“æœå¤„ç†æ¥å£
```go
// ResultProcessor ç»“æœå¤„ç†æ¥å£
type ResultProcessor interface {
    // FormatResult æ ¼å¼åŒ–è¯†åˆ«ç»“æœ
    FormatResult(result *RecognitionResult, format string) (string, error)

    // GenerateAIPrompt ç”ŸæˆAIä¼˜åŒ–æç¤ºè¯
    GenerateAIPrompt(result *RecognitionResult, template string) (string, error)

    // ExportResult å¯¼å‡ºè¯†åˆ«ç»“æœ
    ExportResult(result *RecognitionResult, outputPath, format string) error

    // ValidateFormat éªŒè¯è¾“å‡ºæ ¼å¼
    ValidateFormat(format string) (bool, error)
}
```

### 6.2 å‰ç«¯JavaScript API

#### 6.2.1 éŸ³é¢‘æ–‡ä»¶æ“ä½œ
```javascript
class AudioManager {
    // é€‰æ‹©éŸ³é¢‘æ–‡ä»¶
    async selectAudioFile(): Promise<File>

    // è·å–éŸ³é¢‘ä¿¡æ¯
    async getAudioInfo(filePath: string): Promise<AudioInfo>

    // éªŒè¯éŸ³é¢‘æ–‡ä»¶
    async validateAudioFile(file: File): Promise<boolean>
}
```

#### 6.2.2 è¯­éŸ³è¯†åˆ«æ“ä½œ
```javascript
class RecognitionManager {
    // å¼€å§‹è¯†åˆ«
    async startRecognition(options: RecognitionOptions): Promise<string>

    // åœæ­¢è¯†åˆ«
    async stopRecognition(): Promise<void>

    // è·å–è¯†åˆ«çŠ¶æ€
    async getRecognitionStatus(): Promise<RecognitionStatus>

    // ç›‘å¬è¯†åˆ«è¿›åº¦
    onProgressUpdate(callback: (progress: ProgressInfo) => void): void

    // ç›‘å¬è¯†åˆ«ç»“æœ
    onResultUpdate(callback: (result: RecognitionResult) => void): void
}
```

#### 6.2.3 ç»“æœå¤„ç†æ“ä½œ
```javascript
class ResultManager {
    // æ ¼å¼åŒ–ç»“æœ
    formatResult(result: RecognitionResult, format: string): string

    // ç”ŸæˆAIæç¤ºè¯
    generateAIPrompt(result: RecognitionResult): string

    // å¤åˆ¶åˆ°å‰ªè´´æ¿
    async copyToClipboard(text: string): Promise<boolean>

    // å¯¼å‡ºç»“æœ
    async exportResult(result: RecognitionResult, format: string): Promise<void>
}
```

## 7. ç”¨æˆ·ç•Œé¢è®¾è®¡

### 7.1 ä¸»ç•Œé¢è®¾è®¡

#### 7.1.1 å¸ƒå±€ç»“æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éŸ³é¢‘è¯†åˆ«å·¥å…·                                    [_][â–¡][Ã—]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€ æ–‡ä»¶é€‰æ‹©åŒº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                     â”‚  â”‚
â”‚  â”‚    ğŸµ æ‹–æ‹½éŸ³é¢‘æ–‡ä»¶åˆ°æ­¤å¤„                              â”‚  â”‚
â”‚  â”‚    æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶                                      â”‚  â”‚
â”‚  â”‚                                                     â”‚  â”‚
â”‚  â”‚    å½“å‰æ–‡ä»¶: example.mp3                             â”‚  â”‚
â”‚  â”‚    æ—¶é•¿: 03:45  å¤§å°: 5.2MB                         â”‚  â”‚
â”‚  â”‚                                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€ è¯†åˆ«è®¾ç½®åŒº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  è¯­è¨€: [ä¸­æ–‡ â–¼]     æ¨¡å‹: [é»˜è®¤æ¨¡å‹ â–¼]                â”‚  â”‚
â”‚  â”‚  â˜‘ å¯ç”¨æ™ºèƒ½æ–­å¥     â˜‘ å¯ç”¨éŸ³ä¹æ£€æµ‹                     â”‚  â”‚
â”‚  â”‚  â˜‘ è‡ªåŠ¨ä¼˜åŒ–æ ‡ç‚¹     â–¡ æ˜¾ç¤ºè¯¦ç»†é€‰é¡¹                     â”‚  â”‚
â”‚  â”‚                                                     â”‚  â”‚
â”‚  â”‚  [é«˜çº§è®¾ç½® â–¼]                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€ æ§åˆ¶æŒ‰é’®åŒº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                     â”‚  â”‚
â”‚  â”‚        [ğŸ¤ å¼€å§‹è¯†åˆ«]  [â¹ï¸ åœæ­¢]  [ğŸ”„ é‡ç½®]           â”‚  â”‚
â”‚  â”‚                                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€ è¿›åº¦æ˜¾ç¤ºåŒº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 65%                                  â”‚  â”‚
â”‚  â”‚  å·²ç”¨æ—¶: 00:45  å‰©ä½™: 00:25                           â”‚  â”‚
â”‚  â”‚  çŠ¶æ€: æ­£åœ¨è¯†åˆ«ç¬¬3æ®µ...                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€ ç»“æœæ˜¾ç¤ºåŒº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ [ğŸ“„ åŸå§‹ç»“æœ] [âœ¨ AIä¼˜åŒ–] [ğŸµ å­—å¹•æ¨¡å¼]               â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚[00:00:01.230] å¤§å®¶å¥½ï¼Œæ¬¢è¿ä½¿ç”¨éŸ³é¢‘è¯†åˆ«å·¥å…·          â”‚ â”‚  â”‚
â”‚  â”‚ â”‚[00:00:03.456] è¿™æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è¯­éŸ³è½¬æ–‡å­—åº”ç”¨        â”‚ â”‚  â”‚
â”‚  â”‚ â”‚[00:00:06.789] æ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼è¯†åˆ«                  â”‚ â”‚  â”‚
â”‚  â”‚ â”‚[00:00:09.012] ã€éŸ³ä¹ã€‘èƒŒæ™¯éŸ³ä¹æ’­æ”¾ä¸­ã€/éŸ³ä¹ã€‘         â”‚ â”‚  â”‚
â”‚  â”‚ â”‚...                                               â”‚ â”‚  â”‚
â”‚  â”‚ â”‚                                                   â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€ æ“ä½œæŒ‰é’®åŒº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ [ğŸ“‹ å¤åˆ¶åŸå§‹] [âœ¨ å¤åˆ¶AIæç¤º] [ğŸ’¾ å¯¼å‡ºæ–‡ä»¶] [âš™ï¸ è®¾ç½®]    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 7.1.2 ç»„ä»¶è®¾è®¡è§„èŒƒ

##### é¢œè‰²æ–¹æ¡ˆ
```css
:root {
  /* ä¸»è‰²è°ƒ */
  --primary-color: #4A90E2;
  --primary-hover: #357ABD;
  --primary-light: #E8F4FD;

  /* è¾…åŠ©è‰² */
  --secondary-color: #7B68EE;
  --success-color: #5CB85C;
  --warning-color: #F0AD4E;
  --error-color: #D9534F;

  /* ä¸­æ€§è‰² */
  --background: #FFFFFF;
  --surface: #F8F9FA;
  --border: #DEE2E6;
  --text-primary: #212529;
  --text-secondary: #6C757D;
  --text-disabled: #ADB5BD;
}
```

##### å­—ä½“è§„èŒƒ
```css
:root {
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  --font-size-xs: 0.75rem;    /* 12px */
  --font-size-sm: 0.875rem;   /* 14px */
  --font-size-base: 1rem;     /* 16px */
  --font-size-lg: 1.125rem;   /* 18px */
  --font-size-xl: 1.25rem;    /* 20px */
  --font-size-2xl: 1.5rem;    /* 24px */

  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;

  --line-height-tight: 1.25;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.75;
}
```

##### é—´è·è§„èŒƒ
```css
:root {
  --spacing-xs: 0.25rem;   /* 4px */
  --spacing-sm: 0.5rem;    /* 8px */
  --spacing-md: 1rem;      /* 16px */
  --spacing-lg: 1.5rem;    /* 24px */
  --spacing-xl: 2rem;      /* 32px */
  --spacing-2xl: 3rem;     /* 48px */

  --border-radius-sm: 0.25rem;  /* 4px */
  --border-radius-md: 0.375rem; /* 6px */
  --border-radius-lg: 0.5rem;   /* 8px */

  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
}
```

### 7.2 äº¤äº’è®¾è®¡

#### 7.2.1 ç”¨æˆ·æ“ä½œæµç¨‹

##### åŸºæœ¬è¯†åˆ«æµç¨‹
```mermaid
flowchart TD
    A[å¯åŠ¨åº”ç”¨] --> B[é€‰æ‹©éŸ³é¢‘æ–‡ä»¶]
    B --> C{æ–‡ä»¶æ ¼å¼æ”¯æŒ?}
    C -->|å¦| D[æ˜¾ç¤ºé”™è¯¯æç¤º]
    C -->|æ˜¯| E[æ˜¾ç¤ºéŸ³é¢‘ä¿¡æ¯]
    E --> F[é…ç½®è¯†åˆ«é€‰é¡¹]
    F --> G[ç‚¹å‡»å¼€å§‹è¯†åˆ«]
    G --> H[æ˜¾ç¤ºè¿›åº¦æ¡]
    H --> I[è¯†åˆ«å®Œæˆ]
    I --> J[æ˜¾ç¤ºç»“æœ]
    J --> K{ç”¨æˆ·æ“ä½œ}
    K -->|å¤åˆ¶| L[å¤åˆ¶åˆ°å‰ªè´´æ¿]
    K -->|å¯¼å‡º| M[å¯¼å‡ºæ–‡ä»¶]
    K -->|ä¼˜åŒ–| N[ç”ŸæˆAIæç¤º]
```

##### é”™è¯¯å¤„ç†æµç¨‹
```mermaid
flowchart TD
    A[ç”¨æˆ·æ“ä½œ] --> B{æ˜¯å¦æœ‰æ•ˆæ“ä½œ?}
    B -->|å¦| C[æ˜¾ç¤ºé”™è¯¯æç¤º]
    C --> D[æä¾›è§£å†³å»ºè®®]
    D --> E[è¿”å›æ­£å¸¸çŠ¶æ€]
    B -->|æ˜¯| F[æ‰§è¡Œæ“ä½œ]
    F --> G{æ“ä½œæˆåŠŸ?}
    G -->|å¦| H[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
    H --> I[è®°å½•é”™è¯¯æ—¥å¿—]
    I --> J[å°è¯•æ¢å¤æ“ä½œ]
    G -->|æ˜¯| K[æ˜¾ç¤ºæˆåŠŸåé¦ˆ]
```

#### 7.2.2 å“åº”å¼è®¾è®¡

##### æ–­ç‚¹è®¾ç½®
```css
/* ç§»åŠ¨è®¾å¤‡ */
@media (max-width: 768px) {
  .container {
    padding: var(--spacing-sm);
  }

  .result-display {
    height: 300px;
  }
}

/* å¹³æ¿è®¾å¤‡ */
@media (min-width: 769px) and (max-width: 1024px) {
  .container {
    padding: var(--spacing-md);
  }

  .result-display {
    height: 400px;
  }
}

/* æ¡Œé¢è®¾å¤‡ */
@media (min-width: 1025px) {
  .container {
    padding: var(--spacing-lg);
    max-width: 1200px;
  }

  .result-display {
    height: 500px;
  }
}
```

## 8. å¼€å‘æŒ‡å—

### 8.1 å¼€å‘ç¯å¢ƒæ­å»º

#### 8.1.1 ç³»ç»Ÿè¦æ±‚
- Go 1.21+
- Node.js 16+ (ç”¨äºå‰ç«¯å¼€å‘)
- FFmpeg 4.0+
- Git

#### 8.1.2 å¼€å‘å·¥å…·å®‰è£…
```bash
# å®‰è£…Go
# macOS
brew install go

# Ubuntu/Debian
sudo apt-get install golang-go

# Windows
# ä» https://golang.org/dl/ ä¸‹è½½å®‰è£…åŒ…

# å®‰è£…Node.js
# macOS
brew install node

# Ubuntu/Debian
sudo apt-get install nodejs npm

# Windows
# ä» https://nodejs.org/ ä¸‹è½½å®‰è£…åŒ…

# å®‰è£…FFmpeg
# macOS
brew install ffmpeg

# Ubuntu/Debian
sudo apt-get install ffmpeg

# å®‰è£…Wails CLI
go install github.com/wailsapp/wails/v2/cmd/wails@latest

# éªŒè¯å®‰è£…
wails doctor
```

#### 8.1.3 é¡¹ç›®åˆå§‹åŒ–
```bash
# åˆ›å»ºæ–°é¡¹ç›®
wails init -n audio-recognizer -t vanilla

# è¿›å…¥é¡¹ç›®ç›®å½•
cd audio-recognizer

# å®‰è£…Goä¾èµ–
go mod tidy

# å®‰è£…Vosk Goç»‘å®š
go get github.com/alphacep/vosk-api/go

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
wails dev
```

### 8.2 æ ¸å¿ƒåŠŸèƒ½å®ç°

#### 8.2.1 éŸ³é¢‘å¤„ç†æ¨¡å—
```go
// backend/audio/processor.go
package audio

import (
    "bytes"
    "fmt"
    "os"
    "os/exec"
    "path/filepath"
    "time"
)

type AudioProcessor struct {
    ffmpegPath string
    logger     *logger.Logger
}

func NewAudioProcessor() *AudioProcessor {
    ffmpegPath, _ := exec.LookPath("ffmpeg")
    return &AudioProcessor{
        ffmpegPath: ffmpegPath,
        logger:     logger.New("audio"),
    }
}

// ProcessAudio å¤„ç†éŸ³é¢‘æ–‡ä»¶
func (ap *AudioProcessor) ProcessAudio(inputPath string, options *ProcessingOptions) (*ProcessedAudio, error) {
    // éªŒè¯è¾“å…¥æ–‡ä»¶
    if !ap.validateAudioFile(inputPath) {
        return nil, fmt.Errorf("invalid audio file: %s", inputPath)
    }

    // åˆ›å»ºä¸´æ—¶è¾“å‡ºæ–‡ä»¶
    outputPath := ap.generateTempPath("wav")
    defer os.Remove(outputPath)

    // æ„å»ºFFmpegå‘½ä»¤
    cmd := exec.Command(ap.ffmpegPath,
        "-i", inputPath,
        "-ar", fmt.Sprintf("%d", options.SampleRate),
        "-ac", fmt.Sprintf("%d", options.Channels),
        "-f", "wav",
        "-y", // è¦†ç›–è¾“å‡ºæ–‡ä»¶
        outputPath,
    )

    // æ‰§è¡Œè½¬æ¢
    var stderr bytes.Buffer
    cmd.Stderr = &stderr

    ap.logger.Infof("Processing audio: %s", inputPath)

    if err := cmd.Run(); err != nil {
        return nil, fmt.Errorf("audio processing failed: %v, stderr: %s", err, stderr.String())
    }

    // è·å–éŸ³é¢‘ä¿¡æ¯
    info, err := ap.getAudioInfo(outputPath)
    if err != nil {
        return nil, err
    }

    return &ProcessedAudio{
        Path:     outputPath,
        Info:     info,
        Duration: info.Duration,
    }, nil
}

// GetAudioInfo è·å–éŸ³é¢‘ä¿¡æ¯
func (ap *AudioProcessor) GetAudioInfo(path string) (*AudioFileInfo, error) {
    cmd := exec.Command(ap.ffmpegPath,
        "-i", path,
        "-f", "null",
        "-",
    )

    var stderr bytes.Buffer
    cmd.Stderr = &stderr

    if err := cmd.Run(); err != nil {
        // FFmpegè¿”å›é”™è¯¯ï¼Œä½†ä¿¡æ¯åœ¨stderrä¸­
        if stderr.Len() == 0 {
            return nil, fmt.Errorf("failed to get audio info: %v", err)
        }
    }

    return ap.parseAudioInfo(stderr.String())
}

// validateAudioFile éªŒè¯éŸ³é¢‘æ–‡ä»¶
func (ap *AudioProcessor) validateAudioFile(path string) bool {
    supportedFormats := []string{".mp3", ".wav", ".m4a", ".flac", ".ogg", ".aac"}
    ext := filepath.Ext(path)

    for _, format := range supportedFormats {
        if ext == format {
            return true
        }
    }
    return false
}

// generateTempPath ç”Ÿæˆä¸´æ—¶æ–‡ä»¶è·¯å¾„
func (ap *AudioProcessor) generateTempPath(format string) string {
    timestamp := time.Now().UnixNano()
    return filepath.Join(os.TempDir(), fmt.Sprintf("audio_%d.%s", timestamp, format))
}
```

#### 8.2.2 è¯­éŸ³è¯†åˆ«æ¨¡å—
```go
// backend/recognition/vosk_client.go
package recognition

import (
    "encoding/json"
    "fmt"
    "io"
    "os"
    "path/filepath"
    "time"

    "github.com/alphacep/vosk-api/go"
)

type VoskClient struct {
    models map[string]*vosk.VoskModel
    recognizer *vosk.VoskRecognizer
    logger     *logger.Logger
}

func NewVoskClient() *VoskClient {
    return &VoskClient{
        models: make(map[string]*vosk.VoskModel),
        logger: logger.New("vosk"),
    }
}

// LoadModel åŠ è½½è¯†åˆ«æ¨¡å‹
func (vc *VoskClient) LoadModel(language, modelPath string) error {
    if _, exists := vc.models[language]; exists {
        return nil // æ¨¡å‹å·²åŠ è½½
    }

    // æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    if !vc.modelExists(modelPath) {
        return fmt.Errorf("model not found at path: %s", modelPath)
    }

    vc.logger.Infof("Loading Vosk model for language: %s", language)

    model, err := vosk.NewModel(modelPath)
    if err != nil {
        return fmt.Errorf("failed to load Vosk model: %v", err)
    }

    vc.models[language] = model
    return nil
}

// RecognizeAudio è¯†åˆ«éŸ³é¢‘æ–‡ä»¶
func (vc *VoskClient) RecognizeAudio(audioPath, language string, options *RecognitionOptions) (*RecognitionResult, error) {
    model, exists := vc.models[language]
    if !exists {
        return nil, fmt.Errorf("model not loaded for language: %s", language)
    }

    // åˆ›å»ºè¯†åˆ«å™¨
    recognizer, err := vosk.NewRecognizer(model, options.SampleRate)
    if err != nil {
        return nil, fmt.Errorf("failed to create recognizer: %v", err)
    }
    defer recognizer.Finish()

    // è®¾ç½®è¯†åˆ«å™¨é€‰é¡¹
    recognizer.SetWords(options.WordTimestamps)
    recognizer.SetPartialResults(options.PartialResults)
    recognizer.SetMaxAlternatives(options.MaxAlternatives)

    // æ‰“å¼€éŸ³é¢‘æ–‡ä»¶
    audioFile, err := os.Open(audioPath)
    if err != nil {
        return nil, fmt.Errorf("failed to open audio file: %v", err)
    }
    defer audioFile.Close()

    result := &RecognitionResult{
        Language:   language,
        CreatedAt:  time.Now(),
        Segments:   []RecognitionSegment{},
        Words:      []Word{},
    }

    // è¯»å–éŸ³é¢‘æ•°æ®
    buffer := make([]byte, options.BufferSize)
    segmentStart := time.Now()

    for {
        n, err := audioFile.Read(buffer)
        if err == io.EOF {
            break
        }
        if err != nil {
            return nil, fmt.Errorf("failed to read audio data: %v", err)
        }

        if recognizer.AcceptWaveform(buffer[:n]) {
            // å¤„ç†å®Œæ•´ç»“æœ
            partial := recognizer.Result()
            segment := vc.parseSegmentResult(partial, segmentStart)
            if segment != nil {
                result.Segments = append(result.Segments, *segment)
            }
            segmentStart = time.Now()
        } else if options.PartialResults {
            // å¤„ç†éƒ¨åˆ†ç»“æœï¼ˆç”¨äºå®æ—¶æ˜¾ç¤ºï¼‰
            partial := recognizer.PartialResult()
            // å¯ä»¥å‘é€éƒ¨åˆ†ç»“æœåˆ°å‰ç«¯æ˜¾ç¤º
        }
    }

    // å¤„ç†æœ€ç»ˆç»“æœ
    final := recognizer.FinalResult()
    finalSegment := vc.parseSegmentResult(final, segmentStart)
    if finalSegment != nil {
        result.Segments = append(result.Segments, *finalSegment)
    }

    // è®¡ç®—æ•´ä½“ç½®ä¿¡åº¦
    result.Confidence = vc.calculateConfidence(result.Segments)
    result.ProcessedAt = time.Now()

    return result, nil
}

// parseSegmentResult è§£æç‰‡æ®µç»“æœ
func (vc *VoskClient) parseSegmentResult(jsonResult string, segmentStart time.Time) *RecognitionSegment {
    var segmentData struct {
        Text  string `json:"text"`
        Words []struct {
            Word  string  `json:"word"`
            Start float64 `json:"start"`
            End   float64 `json:"end"`
            Conf  float64 `json:"conf"`
        } `json:"result"`
    }

    if err := json.Unmarshal([]byte(jsonResult), &segmentData); err != nil {
        vc.logger.Errorf("Failed to parse segment result: %v", err)
        return nil
    }

    if len(segmentData.Text) == 0 {
        return nil
    }

    segment := &RecognitionSegment{
        Start:      segmentStart,
        Text:       segmentData.Text,
        Confidence: 0,
        Words:      []Word{},
    }

    var totalConfidence float64
    var wordCount int

    for _, wordData := range segmentData.Words {
        word := Word{
            Text:       wordData.Word,
            Start:      segmentStart.Add(time.Duration(wordData.Start * float64(time.Second))),
            End:        segmentStart.Add(time.Duration(wordData.End * float64(time.Second))),
            Confidence: wordData.Conf,
        }

        segment.Words = append(segment.Words, word)
        totalConfidence += wordData.Conf
        wordCount++

        // è®¾ç½®æ®µè½ç»“æŸæ—¶é—´
        if word.End.After(segment.End) {
            segment.End = word.End
        }
    }

    if wordCount > 0 {
        segment.Confidence = totalConfidence / float64(wordCount)
    }

    return segment
}

// modelExists æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨
func (vc *VoskClient) modelExists(modelPath string) bool {
    requiredFiles := []string{"am/final.mdl", "conf/mfcc.conf", "graph/HCLG.fst"}

    for _, file := range requiredFiles {
        if _, err := os.Stat(filepath.Join(modelPath, file)); os.IsNotExist(err) {
            return false
        }
    }
    return true
}
```

#### 8.2.3 å‰ç«¯JavaScriptå®ç°
```javascript
// frontend/js/app.js
class AudioRecognizerApp {
    constructor() {
        this.audioManager = new AudioManager();
        this.recognitionManager = new RecognitionManager();
        this.resultManager = new ResultManager();

        this.initializeEventListeners();
        this.loadDefaultSettings();
    }

    initializeEventListeners() {
        // æ–‡ä»¶æ‹–æ‹½
        const dropZone = document.getElementById('dropZone');
        dropZone.addEventListener('dragover', this.handleDragOver.bind(this));
        dropZone.addEventListener('drop', this.handleDrop.bind(this));

        // æ–‡ä»¶é€‰æ‹©
        const fileInput = document.getElementById('fileInput');
        fileInput.addEventListener('change', this.handleFileSelect.bind(this));

        // æ§åˆ¶æŒ‰é’®
        document.getElementById('startBtn').addEventListener('click', this.startRecognition.bind(this));
        document.getElementById('stopBtn').addEventListener('click', this.stopRecognition.bind(this));
        document.getElementById('resetBtn').addEventListener('click', this.resetApp.bind(this));

        // ç»“æœæ“ä½œ
        document.getElementById('copyOriginalBtn').addEventListener('click', this.copyOriginalResult.bind(this));
        document.getElementById('copyAIBtn').addEventListener('click', this.copyAIResult.bind(this));
        document.getElementById('exportBtn').addEventListener('click', this.exportResult.bind(this));
    }

    async handleFileSelect(event) {
        const file = event.target.files[0];
        if (!file) return;

        await this.processAudioFile(file);
    }

    async handleDrop(event) {
        event.preventDefault();
        const file = event.dataTransfer.files[0];
        if (!file) return;

        await this.processAudioFile(file);
    }

    async processAudioFile(file) {
        try {
            this.showLoading(true);

            // éªŒè¯éŸ³é¢‘æ–‡ä»¶
            const isValid = await this.audioManager.validateAudioFile(file);
            if (!isValid) {
                throw new Error('ä¸æ”¯æŒçš„éŸ³é¢‘æ ¼å¼');
            }

            // è·å–éŸ³é¢‘ä¿¡æ¯
            const audioInfo = await this.audioManager.getAudioInfo(file.path);
            this.displayAudioInfo(audioInfo);

            // å¯ç”¨å¼€å§‹æŒ‰é’®
            document.getElementById('startBtn').disabled = false;

        } catch (error) {
            this.showError('æ–‡ä»¶å¤„ç†å¤±è´¥: ' + error.message);
        } finally {
            this.showLoading(false);
        }
    }

    async startRecognition() {
        try {
            const options = this.getRecognitionOptions();

            this.recognitionManager.onProgressUpdate((progress) => {
                this.updateProgress(progress);
            });

            this.recognitionManager.onResultUpdate((result) => {
                this.displayResult(result);
            });

            await this.recognitionManager.startRecognition(options);

            // æ›´æ–°UIçŠ¶æ€
            document.getElementById('startBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;

        } catch (error) {
            this.showError('è¯†åˆ«å¯åŠ¨å¤±è´¥: ' + error.message);
        }
    }

    async stopRecognition() {
        try {
            await this.recognitionManager.stopRecognition();

            // æ›´æ–°UIçŠ¶æ€
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;

        } catch (error) {
            this.showError('åœæ­¢è¯†åˆ«å¤±è´¥: ' + error.message);
        }
    }

    getRecognitionOptions() {
        return {
            language: document.getElementById('languageSelect').value,
            modelPath: document.getElementById('modelPath').value,
            enableWordTimestamp: document.getElementById('wordTimestamp').checked,
            maxAlternatives: parseInt(document.getElementById('maxAlternatives').value),
            confidenceThreshold: parseFloat(document.getElementById('confidenceThreshold').value)
        };
    }

    displayResult(result) {
        const resultDisplay = document.getElementById('resultDisplay');
        const formattedResult = this.resultManager.formatResult(result, 'timestamp');
        resultDisplay.value = formattedResult;

        // å­˜å‚¨å½“å‰ç»“æœ
        this.currentResult = result;
    }

    async copyOriginalResult() {
        if (!this.currentResult) {
            this.showError('æ²¡æœ‰å¯å¤åˆ¶çš„ç»“æœ');
            return;
        }

        const originalText = this.resultManager.formatResult(this.currentResult, 'original');
        await this.copyToClipboard(originalText);
        this.showSuccess('åŸå§‹ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
    }

    async copyAIResult() {
        if (!this.currentResult) {
            this.showError('æ²¡æœ‰å¯å¤åˆ¶çš„ç»“æœ');
            return;
        }

        const aiPrompt = this.resultManager.generateAIPrompt(this.currentResult);
        await this.copyToClipboard(aiPrompt);
        this.showSuccess('AIä¼˜åŒ–æç¤ºå·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
    }

    showLoading(show) {
        const loading = document.getElementById('loading');
        loading.style.display = show ? 'block' : 'none';
    }

    showError(message) {
        const errorToast = document.getElementById('errorToast');
        errorToast.textContent = message;
        errorToast.style.display = 'block';

        setTimeout(() => {
            errorToast.style.display = 'none';
        }, 5000);
    }

    showSuccess(message) {
        const successToast = document.getElementById('successToast');
        successToast.textContent = message;
        successToast.style.display = 'block';

        setTimeout(() => {
            successToast.style.display = 'none';
        }, 3000);
    }
}

// åˆå§‹åŒ–åº”ç”¨
document.addEventListener('DOMContentLoaded', () => {
    new AudioRecognizerApp();
});
```

### 8.3 æµ‹è¯•æŒ‡å—

#### 8.3.1 å•å…ƒæµ‹è¯•
```go
// backend/recognition/vosk_client_test.go
package recognition

import (
    "testing"
    "time"
)

func TestVoskClient_LoadModel(t *testing.T) {
    client := NewVoskClient()

    // æµ‹è¯•åŠ è½½ä¸å­˜åœ¨çš„æ¨¡å‹
    err := client.LoadModel("zh", "/invalid/path")
    if err == nil {
        t.Error("Expected error when loading invalid model path")
    }

    // æµ‹è¯•åŠ è½½æœ‰æ•ˆæ¨¡å‹ï¼ˆéœ€è¦å®é™…æ¨¡å‹æ–‡ä»¶ï¼‰
    // err = client.LoadModel("zh", "./models/zh-CN")
    // if err != nil {
    //     t.Errorf("Failed to load valid model: %v", err)
    // }
}

func TestVoskClient_ParseSegmentResult(t *testing.T) {
    client := NewVoskClient()

    jsonResult := `{
        "text": "hello world",
        "result": [
            {
                "word": "hello",
                "start": 0.0,
                "end": 0.5,
                "conf": 0.9
            },
            {
                "word": "world",
                "start": 0.6,
                "end": 1.1,
                "conf": 0.8
            }
        ]
    }`

    segmentStart := time.Now()
    segment := client.parseSegmentResult(jsonResult, segmentStart)

    if segment == nil {
        t.Error("Expected non-nil segment")
    }

    if segment.Text != "hello world" {
        t.Errorf("Expected text 'hello world', got '%s'", segment.Text)
    }

    if len(segment.Words) != 2 {
        t.Errorf("Expected 2 words, got %d", len(segment.Words))
    }
}
```

#### 8.3.2 é›†æˆæµ‹è¯•
```go
// tests/integration/recognition_test.go
package integration

import (
    "os"
    "path/filepath"
    "testing"
    "time"

    "github.com/stretchr/testify/assert"
)

func TestFullRecognitionFlow(t *testing.T) {
    if testing.Short() {
        t.Skip("Skipping integration test in short mode")
    }

    // å‡†å¤‡æµ‹è¯•éŸ³é¢‘æ–‡ä»¶
    audioPath := filepath.Join("testdata", "test_audio.wav")
    if _, err := os.Stat(audioPath); os.IsNotExist(err) {
        t.Skip("Test audio file not found")
    }

    // åˆ›å»ºéŸ³é¢‘å¤„ç†å™¨
    processor := audio.NewAudioProcessor()

    // å¤„ç†éŸ³é¢‘
    processedAudio, err := processor.ProcessAudio(audioPath, &audio.ProcessingOptions{
        SampleRate: 16000,
        Channels:   1,
    })
    assert.NoError(t, err)
    assert.NotNil(t, processedAudio)

    // åˆ›å»ºè¯†åˆ«å®¢æˆ·ç«¯
    client := recognition.NewVoskClient()

    // åŠ è½½æ¨¡å‹ï¼ˆéœ€è¦å®é™…æ¨¡å‹æ–‡ä»¶ï¼‰
    modelPath := filepath.Join("..", "models", "zh-CN")
    if _, err := os.Stat(modelPath); os.IsNotExist(err) {
        t.Skip("Model file not found")
    }

    err = client.LoadModel("zh", modelPath)
    assert.NoError(t, err)

    // æ‰§è¡Œè¯†åˆ«
    result, err := client.RecognizeAudio(processedAudio.Path, "zh", &recognition.RecognitionOptions{
        SampleRate:         16000,
        WordTimestamps:     true,
        PartialResults:     false,
        MaxAlternatives:    1,
    })

    assert.NoError(t, err)
    assert.NotNil(t, result)
    assert.NotEmpty(t, result.Segments)
    assert.Greater(t, result.Confidence, 0.0)

    // æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    os.Remove(processedAudio.Path)
}
```

## 9. éƒ¨ç½²æŒ‡å—

### 9.1 æ„å»ºé…ç½®

#### 9.1.1 Wailsé…ç½®æ–‡ä»¶
```json
// wails.json
{
  "$schema": "https://wails.io/schemas/config.v2.json",
  "name": "audio-recognizer",
  "outputfilename": "audio-recognizer",
  "frontend": {
    "dir": "./frontend",
    "install": "npm install",
    "build": "npm run build",
    "dev": "npm run dev",
    "package": {
      "manager": "npm"
    }
  },
  "backend": {
    "dir": "./backend",
    "go": {
      "main": "./main.go",
      "ldflags": "-s -w"
    }
  },
  "author": {
    "name": "Your Name",
    "email": "your.email@example.com"
  },
  "info": {
    "productName": "Audio Recognizer",
    "productVersion": "1.0.0",
    "copyright": "Copyright Â© 2024 Your Name",
    "comments": "A cross-platform audio recognition tool"
  },
  "nsisType": "multiple",
  "obfuscated": false,
  "garbleargs": "",
  "upx": false,
  "upxflags": "",
  "runNonNativeBuildHooks": false,
  "buildtags": "",
  "windowStartState": "normal"
}
```

#### 9.1.2 æ„å»ºè„šæœ¬
```bash
#!/bin/bash
# scripts/build.sh

set -e

# æ¸…ç†ä¹‹å‰çš„æ„å»º
echo "Cleaning previous builds..."
rm -rf build/

# å®‰è£…ä¾èµ–
echo "Installing dependencies..."
go mod tidy
cd frontend && npm install && cd ..

# ä¸‹è½½è¯­éŸ³æ¨¡å‹
echo "Downloading speech models..."
./scripts/download-models.sh

# æ„å»ºå‰ç«¯
echo "Building frontend..."
cd frontend && npm run build && cd ..

# æ„å»ºåº”ç”¨
echo "Building application..."
wails build -clean -production

echo "Build completed successfully!"
```

```bash
#!/bin/bash
# scripts/download-models.sh

set -e

MODEL_DIR="./models"
BASE_URL="https://alphacephei.com/vosk/models"

# åˆ›å»ºæ¨¡å‹ç›®å½•
mkdir -p "$MODEL_DIR"

# ä¸‹è½½ä¸­æ–‡æ¨¡å‹
if [ ! -d "$MODEL_DIR/zh-CN" ]; then
    echo "Downloading Chinese model..."
    curl -L "${BASE_URL}/vosk-model-small-cn-0.22.zip" -o /tmp/zh-CN-model.zip
    unzip /tmp/zh-CN-model.zip -d "$MODEL_DIR"
    mv "$MODEL_DIR/vosk-model-small-cn-0.22" "$MODEL_DIR/zh-CN"
    rm /tmp/zh-CN-model.zip
fi

# ä¸‹è½½è‹±æ–‡æ¨¡å‹
if [ ! -d "$MODEL_DIR/en-US" ]; then
    echo "Downloading English model..."
    curl -L "${BASE_URL}/vosk-model-small-en-us-0.15.zip" -o /tmp/en-US-model.zip
    unzip /tmp/en-US-model.zip -d "$MODEL_DIR"
    mv "$MODEL_DIR/vosk-model-small-en-us-0.15" "$MODEL_DIR/en-US"
    rm /tmp/en-US-model.zip
fi

echo "Model download completed!"
```

### 9.2 å¹³å°ç‰¹å®šæ„å»º

#### 9.2.1 macOSæ„å»º
```bash
#!/bin/bash
# scripts/build-macos.sh

# è®¾ç½®ç¯å¢ƒå˜é‡
export GOOS=darwin
export GOARCH=amd64
export CGO_ENABLED=1

# å®‰è£…macOSä¾èµ–
brew install ffmpeg

# æ„å»ºåº”ç”¨
wails build -platform darwin/amd64 -clean

# åˆ›å»ºDMGå®‰è£…åŒ…
mkdir -p build/dmg
cp build/audio-recognizer.app build/dmg/
hdiutil create -volname "Audio Recognizer" -srcfolder build/dmg -ov -format UDZO build/audio-recognizer.dmg

echo "macOS build completed!"
```

#### 9.2.2 Windowsæ„å»º
```bash
#!/bin/bash
# scripts/build-windows.sh

# è®¾ç½®ç¯å¢ƒå˜é‡
export GOOS=windows
export GOARCH=amd64
export CGO_ENABLED=1
export CC=x86_64-w64-mingw32-gcc

# æ„å»ºåº”ç”¨
wails build -platform windows/amd64 -clean

# åˆ›å»ºå®‰è£…ç¨‹åº
# ä½¿ç”¨NSISæˆ–å…¶ä»–å®‰è£…ç¨‹åºåˆ¶ä½œå·¥å…·

echo "Windows build completed!"
```

#### 9.2.3 Linuxæ„å»º
```bash
#!/bin/bash
# scripts/build-linux.sh

# è®¾ç½®ç¯å¢ƒå˜é‡
export GOOS=linux
export GOARCH=amd64
export CGO_ENABLED=1

# å®‰è£…Linuxä¾èµ–
sudo apt-get update
sudo apt-get install -y ffmpeg libasound2-dev

# æ„å»ºåº”ç”¨
wails build -platform linux/amd64 -clean

# åˆ›å»ºAppImage
./scripts/create-appimage.sh

echo "Linux build completed!"
```

### 9.3 éƒ¨ç½²æ£€æŸ¥æ¸…å•

#### 9.3.1 æ„å»ºå‰æ£€æŸ¥
- [ ] ä»£ç ç¼–è¯‘æ— é”™è¯¯
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä¾èµ–ç‰ˆæœ¬å…¼å®¹
- [ ] é…ç½®æ–‡ä»¶æ­£ç¡®
- [ ] èµ„æºæ–‡ä»¶å®Œæ•´
- [ ] è¯­éŸ³æ¨¡å‹ä¸‹è½½å®Œæˆ

#### 9.3.2 æ„å»ºåæ£€æŸ¥
- [ ] åº”ç”¨ç¨‹åºæ­£å¸¸å¯åŠ¨
- [ ] åŸºæœ¬åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] éŸ³é¢‘æ–‡ä»¶è¯†åˆ«æ­£å¸¸
- [ ] ç»“æœå¯¼å‡ºåŠŸèƒ½æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†æ­£å¸¸
- [ ] æ€§èƒ½æ»¡è¶³è¦æ±‚

#### 9.3.3 æ‰“åŒ…æ£€æŸ¥
- [ ] å®‰è£…åŒ…å¤§å°åˆç†
- [ ] ä¾èµ–åº“åŒ…å«å®Œæ•´
- [ ] æ•°å­—ç­¾åæœ‰æ•ˆï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- [ ] å®‰è£…ç¨‹åºæ­£å¸¸å·¥ä½œ
- [ ] å¸è½½ç¨‹åºæ­£å¸¸å·¥ä½œ

### 9.4 å‘å¸ƒæµç¨‹

#### 9.4.1 ç‰ˆæœ¬ç®¡ç†
```bash
# åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
git tag -a v1.0.0 -m "Release version 1.0.0"

# æ¨é€æ ‡ç­¾
git push origin v1.0.0
```

#### 9.4.2 è‡ªåŠ¨åŒ–å‘å¸ƒï¼ˆGitHub Actionsï¼‰
```yaml
# .github/workflows/release.yml
name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]

    runs-on: ${{ matrix.os }}

    steps:
    - uses: actions/checkout@v3

    - name: Setup Go
      uses: actions/setup-go@v3
      with:
        go-version: '1.21'

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '16'

    - name: Install dependencies (Ubuntu)
      if: matrix.os == 'ubuntu-latest'
      run: |
        sudo apt-get update
        sudo apt-get install -y ffmpeg libasound2-dev

    - name: Install dependencies (macOS)
      if: matrix.os == 'macos-latest'
      run: |
        brew install ffmpeg

    - name: Install dependencies (Windows)
      if: matrix.os == 'windows-latest'
      run: |
        choco install ffmpeg

    - name: Download models
      run: ./scripts/download-models.sh

    - name: Build application
      run: wails build -production

    - name: Upload artifacts
      uses: actions/upload-artifact@v3
      with:
        name: ${{ matrix.os }}-build
        path: build/
```

## 10. æ€»ç»“

æœ¬è®¾è®¡æ–‡æ¡£è¯¦ç»†æè¿°äº†éŸ³é¢‘è¯†åˆ«åº”ç”¨çš„å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š

1. **é¡¹ç›®æ¦‚è¿°**: æ˜ç¡®äº†åº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½å’Œç›®æ ‡ç”¨æˆ·
2. **éœ€æ±‚åˆ†æ**: è¯¦ç»†åˆ—å‡ºäº†åŠŸèƒ½æ€§å’ŒéåŠŸèƒ½æ€§éœ€æ±‚
3. **æŠ€æœ¯æ–¹æ¡ˆ**: é€‰æ‹©äº†åˆé€‚çš„æŠ€æœ¯æ ˆå’Œæ¶æ„è®¾è®¡
4. **ç³»ç»Ÿè®¾è®¡**: è§„åˆ’äº†é¡¹ç›®ç»“æ„å’Œæ ¸å¿ƒç»„ä»¶
5. **æ•°æ®æ¨¡å‹**: è®¾è®¡äº†å®Œæ•´çš„æ•°æ®ç»“æ„å’Œæ–‡æœ¬è§„èŒƒ
6. **æ¥å£è®¾è®¡**: å®šä¹‰äº†å‰åç«¯APIæ¥å£è§„èŒƒ
7. **ç•Œé¢è®¾è®¡**: æä¾›äº†è¯¦ç»†çš„UIè®¾è®¡å’Œäº¤äº’è§„èŒƒ
8. **å¼€å‘æŒ‡å—**: åŒ…å«äº†ç¯å¢ƒæ­å»ºå’Œæ ¸å¿ƒåŠŸèƒ½å®ç°
9. **æµ‹è¯•æŒ‡å—**: åˆ¶å®šäº†å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•æ–¹æ¡ˆ
10. **éƒ¨ç½²æŒ‡å—**: è¯¦ç»†è¯´æ˜äº†æ„å»ºå’Œå‘å¸ƒæµç¨‹

è¯¥è®¾è®¡æ–¹æ¡ˆå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

- âœ… **æŠ€æœ¯å…ˆè¿›**: ä½¿ç”¨ç°ä»£åŒ–æŠ€æœ¯æ ˆï¼Œæ€§èƒ½ä¼˜ç§€
- âœ… **æ¶æ„æ¸…æ™°**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•
- âœ… **ç”¨æˆ·å‹å¥½**: ç®€æ´ç›´è§‚çš„ç•Œé¢è®¾è®¡
- âœ… **è·¨å¹³å°**: æ”¯æŒä¸»æµæ“ä½œç³»ç»Ÿ
- âœ… **å¯æ‰©å±•**: æ”¯æŒè‡ªå®šä¹‰æ¨¡å‹å’ŒåŠŸèƒ½æ‰©å±•
- âœ… **é«˜æ€§èƒ½**: ä¼˜åŒ–çš„éŸ³é¢‘å¤„ç†å’Œè¯†åˆ«ç®—æ³•

åŸºäºæ­¤è®¾è®¡æ–¹æ¡ˆï¼Œå¯ä»¥å¼€å§‹å…·ä½“çš„ä»£ç å®ç°å·¥ä½œã€‚å»ºè®®é‡‡ç”¨æ•æ·å¼€å‘æ–¹å¼ï¼Œé€æ­¥å®ç°å„ä¸ªåŠŸèƒ½æ¨¡å—ï¼Œå¹¶åœ¨æ¯ä¸ªé˜¶æ®µè¿›è¡Œå……åˆ†çš„æµ‹è¯•éªŒè¯ã€‚